# ğŸŒŸ æ˜ŸéœœPro ç¾¤ç»„ç®¡ç†ç³»ç»Ÿ

åŸºäº Cloudflare Workers + D1 æ•°æ®åº“çš„ Telegram ç¾¤ç»„ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ›¡ï¸ **å…¥ç¾¤å®¡æ ¸** - è‡ªåŠ¨æ£€æµ‹å¤´åƒã€ä¸­æ–‡åã€è¿ç¦è¯
- ğŸš« **å°ç¦ç®¡ç†** - è‡ªåŠ¨å°ç¦ã€æ‰‹åŠ¨è§£å°ã€å°ç¦è®°å½•
- âœ… **ç™½åå•ç³»ç»Ÿ** - å…¨å±€/ç¾¤ç»„ç™½åå•ã€æ‰¹é‡å¯¼å…¥
- ğŸ‘‘ **ç®¡ç†å‘˜åˆ†çº§** - è¶…çº§ç®¡ç†å‘˜ + æ™®é€šç®¡ç†å‘˜
- ğŸ”” **å®æ—¶é€šçŸ¥** - å°ç¦äº‹ä»¶æ¨é€ç»™ç®¡ç†å‘˜
- ğŸ“ **è¿ç¦è¯åº“** - å¯è‡ªå®šä¹‰è¿ç¦è¯åˆ—è¡¨
- ğŸ“‹ **å®Œæ•´æ—¥å¿—** - æ‰€æœ‰æ“ä½œå®¡è®¡è®°å½•

### æŠ€æœ¯äº®ç‚¹
- â˜ï¸ äº‘åŸç”Ÿ Serverless æ¶æ„
- ğŸ“± Telegram Web App åŸç”Ÿé›†æˆ
- âš¡ è¾¹ç¼˜è®¡ç®—ï¼Œå…¨çƒåŠ é€Ÿ
- ğŸ”’ åŒé‡è®¤è¯æœºåˆ¶

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### 1. å‡†å¤‡å·¥ä½œ

1. å®‰è£… [Node.js](https://nodejs.org/) (18+)
2. å®‰è£… Wrangler CLI:
   ```bash
   npm install -g wrangler
   ```
3. ç™»å½• Cloudflare:
   ```bash
   wrangler login
   ```

### 2. åˆ›å»º Telegram Bot

1. åœ¨ Telegram ä¸­æ‰¾åˆ° [@BotFather](https://t.me/BotFather)
2. å‘é€ `/newbot` åˆ›å»ºæœºå™¨äºº
3. ä¿å­˜è·å¾—çš„ Bot Token
4. å‘é€ `/setprivacy` é€‰æ‹© `Disable` (å…è®¸è¯»å–æ‰€æœ‰æ¶ˆæ¯)
5. å‘é€ `/setjoingroups` é€‰æ‹© `Enable`

### 3. åˆ›å»º D1 æ•°æ®åº“

```bash
# åˆ›å»ºæ•°æ®åº“
wrangler d1 create xingshuang-pro-db

# å¤åˆ¶è¾“å‡ºçš„ database_idï¼Œæ›´æ–°åˆ° wrangler.toml
```

### 4. é…ç½®ç¯å¢ƒå˜é‡

```bash
# è®¾ç½® Bot Tokenï¼ˆæ•æ„Ÿä¿¡æ¯ä½¿ç”¨ secretï¼‰
wrangler secret put BOT_TOKEN
# è¾“å…¥ä½ çš„ Bot Token

# è®¾ç½® Webhook å¯†é’¥ï¼ˆå¯é€‰ï¼‰
wrangler secret put WEBHOOK_SECRET
# è¾“å…¥ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²

# è®¾ç½®è¶…çº§ç®¡ç†å‘˜ï¼ˆåœ¨ wrangler.toml ä¸­é…ç½®æˆ–ä½¿ç”¨ secretï¼‰
wrangler secret put SUPER_ADMINS
# è¾“å…¥ç®¡ç†å‘˜ Telegram IDï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”
```

### 5. éƒ¨ç½²

```bash
# éƒ¨ç½²åˆ° Cloudflare Workers
wrangler deploy
```

### 6. è®¾ç½® Webhook

éƒ¨ç½²æˆåŠŸåï¼Œè®¿é—®ä½ çš„ Worker URLï¼Œç™»å½•ç®¡ç†é¢æ¿åï¼š
1. ç‚¹å‡» "æ§åˆ¶é¢æ¿"
2. ç‚¹å‡» "è®¾ç½® Webhook"
3. URL é»˜è®¤ä¸º `https://your-worker.workers.dev/webhook`
4. ç‚¹å‡» "è®¾ç½®"

### 7. é…ç½® Bot ä¸ºç¾¤ç»„ç®¡ç†å‘˜

1. å°† Bot æ·»åŠ åˆ°ç¾¤ç»„
2. è®¾ç½® Bot ä¸ºç®¡ç†å‘˜
3. æˆäºˆä»¥ä¸‹æƒé™ï¼š
   - åˆ é™¤æ¶ˆæ¯
   - å°ç¦ç”¨æˆ·
   - é‚€è¯·ç”¨æˆ·

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ç®¡ç†é¢æ¿

è®¿é—® Worker URL å³å¯æ‰“å¼€ç®¡ç†é¢æ¿ï¼š
- é€šè¿‡ Telegram Web App æ‰“å¼€ï¼ˆæ¨èï¼‰
- ç›´æ¥æµè§ˆå™¨è®¿é—®ï¼ˆå¼€å‘æ¨¡å¼ï¼‰

### Bot å‘½ä»¤

| å‘½ä»¤ | æè¿° |
|------|------|
| `/start` | å¯åŠ¨æœºå™¨äºº |
| `/status` | æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€ï¼ˆç®¡ç†å‘˜ï¼‰ |
| `/help` | æŸ¥çœ‹å¸®åŠ© |

### ç¾¤ç»„è®¾ç½®

| è®¾ç½® | è¯´æ˜ |
|------|------|
| é˜²å¹¿å‘Šæ£€æµ‹ | æ£€æµ‹ç”¨æˆ·åä¸­çš„è¿ç¦è¯ |
| ä¸­æ–‡åè¦æ±‚ | è¦æ±‚ç”¨æˆ·ååŒ…å«ä¸­æ–‡å­—ç¬¦ |
| å¤´åƒè¦æ±‚ | è¦æ±‚ç”¨æˆ·è®¾ç½®å¤´åƒ |
| å°ç¦æ—¶é•¿ | 1å°æ—¶/24å°æ—¶/7å¤©/æ°¸ä¹… |

## ğŸ”§ é…ç½®è¯´æ˜

### wrangler.toml

```toml
name = "xingshuang-pro"
main = "worker.js"
compatibility_date = "2024-01-01"

[[d1_databases]]
binding = "DB"
database_name = "xingshuang-pro-db"
database_id = "your-database-id"

[vars]
# éæ•æ„Ÿå˜é‡
```

### ç¯å¢ƒå˜é‡

| å˜é‡å | å¿…å¡« | è¯´æ˜ |
|--------|------|------|
| BOT_TOKEN | âœ… | Telegram Bot Token |
| SUPER_ADMINS | âœ… | è¶…çº§ç®¡ç†å‘˜IDï¼ˆé€—å·åˆ†éš”ï¼‰ |
| WEBHOOK_SECRET | âŒ | Webhook å®‰å…¨å¯†é’¥ |

## ğŸ›¡ï¸ å®‰å…¨å»ºè®®

1. ä½¿ç”¨ `wrangler secret` å­˜å‚¨æ•æ„Ÿä¿¡æ¯
2. è®¾ç½® WEBHOOK_SECRET éªŒè¯è¯·æ±‚
3. å®šæœŸæ£€æŸ¥ç®¡ç†å‘˜åˆ—è¡¨
4. ç›‘æ§ç³»ç»Ÿæ—¥å¿—

## ğŸ“Š æ•°æ®åº“ç»“æ„

| è¡¨å | è¯´æ˜ |
|------|------|
| groups | ç¾¤ç»„é…ç½® |
| bans | å°ç¦è®°å½• |
| whitelist | ç™½åå• |
| admins | ç®¡ç†å‘˜ |
| notifications | é€šçŸ¥è®¾ç½® |
| ban_words | è¿ç¦è¯ |
| logs | ç³»ç»Ÿæ—¥å¿— |
| sessions | ä¼šè¯ç®¡ç† |

## ğŸ”„ æ›´æ–°éƒ¨ç½²

```bash
# æ‹‰å–æœ€æ–°ä»£ç å
wrangler deploy
```

## â“ å¸¸è§é—®é¢˜

### Q: Bot æ— æ³•æ”¶åˆ°å…¥ç¾¤è¯·æ±‚ï¼Ÿ
A: æ£€æŸ¥ç¾¤ç»„è®¾ç½®æ˜¯å¦å¼€å¯äº†"æ–°æˆå‘˜éœ€æ‰¹å‡†"

### Q: ç®¡ç†é¢æ¿æ— æ³•ç™»å½•ï¼Ÿ
A: ç¡®è®¤ä½ çš„ Telegram ID å·²æ·»åŠ åˆ° SUPER_ADMINS

### Q: Webhook è®¾ç½®å¤±è´¥ï¼Ÿ
A: æ£€æŸ¥ Worker URL æ˜¯å¦å¯è®¿é—®ï¼Œç¡®è®¤ Bot Token æ­£ç¡®

## ğŸ“ å¼€æºåè®®

MIT License

## ğŸ™ è‡´è°¢

- [Cloudflare Workers](https://workers.cloudflare.com/)
- [Telegram Bot API](https://core.telegram.org/bots/api)
- [Tailwind CSS](https://tailwindcss.com/)